# Machine learning based simple movie recomendation system
## python version 3.11.10

```pip install -r requirements.txt``` 
### Team memebers:

Tugambayeva Aruzhan;
Lyailya Dzhumagulova;
Aitzhanov Sultan; 
Vyacheslav Popov;
Tamerlan Kabdolla. 
## Main statements


### Model architecture is VAE

![image](https://github.com/user-attachments/assets/3b392b96-eab9-4cb3-af9b-043e4fec92c4)


The essence of the model is to train it to find the main features from the data and form them into a vector of limited length
and restore the original data from it.
in the future we will only need the first part of the autoencoder "encoder". This process is called feature extraction.

After successful training, we will have a working encoder that will form vectors describing our films.

Using the cosine similarity or any other, we will be able to compare each film mathematically as in the KNN model.

Similar films will be located nearby in our multidimensional vector space.

(The cosine similarity will show for the same film a distance of 1 for the opposite -1, neutral 0, the more similarities between films, the closer to 1 the distance will be)

Based on this data, we will issue recommendations based on the films that the user marked as liked, as well as on the request that the user writes himself. by cosine distance, you can issue the closest to 1. 

## Data format 

We use own tokenizer for text data representation.
For example string like: "hello : – my friendOOO" would be like: [877, 1320, 1744, 9374, 11894, 2834, 672, 986, 1530, 1650, 15] in number form.

Each token has max length 2 characters. It can be longer if you want, but in our case i think 2 chars pretty enough.

## WEB page
backend written on Flask.

We have simple form where we can choose user, and write prefered genre and description for movie.

On "My films" side we can see movies which user marked as liked. And in the "Recomendations we show our recomendations from ML model"

## Motivation and Objective (Problem, Challenge)
Motivation: Finding the perfect movie to watch is a challenge for many people due to the overwhelming number of options available today. While many streaming platforms focus on popular or trending films, they often overlook individual user preferences, leaving many unique and lesser-known films undiscovered. This project seeks to bridge this gap by creating a recommendation platform that understands user tastes and provides highly personalized movie suggestions, helping users discover hidden gems alongside popular choices.

Objective: The goal of this project is to develop a machine learning-based film recommendation system that effectively personalizes suggestions for users. Using a custom tokenizer and feature vectorization, the system extracts meaningful features from movie data and represents them in a lower-dimensional vector space. Recommendations are generated by comparing feature vectors using cosine similarity. The system will be deployed through a user-friendly web interface, enabling users to explore films based on their viewing history and preferences.

## Related Work and Originality
Related Work: Several implementations of movie recommendation systems have been developed and studied, as evidenced by over 3,264 code implementations and 158 movie-related datasets available on Kaggle. These implementations often leverage collaborative filtering, content-based filtering, or hybrid approaches to generate recommendations. For reference, we also explored resources such as Yandex articles on artificial intelligence to understand state-of-the-art techniques in recommendation systems.

From these sources, we adopted ideas for designing the front-end architecture, developing the recommendation system, and visualizing metrics. However, we found limitations in the available datasets, such as incomplete or inconsistent film data. As a result, we built a custom dataset to address these issues and ensure the quality and comprehensiveness of our movie data.

Originality: Unlike many existing platforms that focus primarily on recommending popular or trending films, our project emphasizes personalized recommendations based on individual user preferences. It stands out by helping users discover lesser-known and unique films, which are often overlooked by mainstream recommendation systems. Additionally, our approach includes:

Building a custom tokenizer to effectively process movie descriptions. Creating a custom dataset using Python-based web scraping to ensure high-quality and complete data. Implementing a unique combination of feature vectorization and cosine similarity for precise recommendations. This approach enhances the user experience by offering fresh and diverse suggestions tailored to their tastes, making our solution both innovative and impactful.
## Design Architecture

1. Data Collection
   * Web scraping using Python libraries to extract data from sources like kinogo.net and kinopoisk.ru.
   * The scraped data includes essential features: Title, Year, Country, Genre, Duration, Director, Cast, and Description.
  
2. Data Preprocessing and Feature Extraction
   * Tokenizer Module
   * Feature Vectorization
  
3. Recommendation Engine
   * Cosine Similarity
   * Top-N Recommendation
  
4. Web Application
   * Framework: Built using Flask
   * Users can view recommended films based on their preferences.
   * Filter allow users to explore movies by genre
  
5. Metrics and Performance Monitoring Layer
   * Accuracy
   * Training and Testing Loss
   * Cosine Similarity Scores
   * KL Divergence
  
  

## Detailed Algorithm or Functions
1. **Data Collection Algorithm**
* Use Python libraries to scrape web pages.
* Parse the HTML content to extract specific movie details.
* Store data as structured JSON files.

2. **Data Preprocessing and Tokenization**
* Input: Raw text data (movie descriptions).
* Tokenize descriptions into individual words or characters.
* Create a vocabulary of unique tokens.
* Map tokens to unique indices.
* Convert descriptions into numerical sequences based on token indices.

3.  **Feature Vectorization**
* Input: Tokenized descriptions, genre labels, and other numerical features.
* Normalize numerical features (e.g., duration, year) to ensure uniform scaling.
* Concatenate tokenized description vectors with genre and other features to form a multi-dimensional feature vector.

4. **Similarity Calculation**
* $$ \text{Cosine Similarity} = \frac{\text{Vector1} \cdot \text{Vector2}}{\|\text{Vector1}\| \times \|\text{Vector2}\|} $$

5. **Recommendation Generation**
* Retrieve the feature vector for the target movie.
* Compute cosine similarity between the target vector and all other movie vectors.
* Sort movies by similarity scores in descending order.
* Select the top-N movies as recommendations.




## Coding

You can find files with code by  this github link: https://github.com/TamerPC/MovieRecomndation

## Results and Performance Evaluation

Model Accuracy: We achieved an accuracy of 99.75% on test data.

Cosine Similarity: The cosine similarity is used to measure the closeness of films based on the encoder-generated vectors. The closer the cosine similarity value is to 1, the more similar the films are.

Real-time Recommendations: The system is able to provide accurate recommendations based on user history and film features.

Kullback-Leibler (KL) Divergence: KL Divergence was used during the training phase to measure how much the predicted distribution deviates from the actual data distribution. Minimizing KL Divergence ensures that the autoencoder's encoded features are close to the original data distribution, which improves the accuracy of the model.

Training/Testing Loss: The model’s performance during training and testing was evaluated using the loss function.



## Conclusion

In this project, we developed a personalized film recommendation system using a machine learning approach that combines autoencoders for feature extraction and cosine similarity for similarity-based recommendations.

The encoder successfully transformed high-dimensional film data into compact, meaningful vectors, allowing us to represent films in a multidimensional vector space. By using cosine similarity, we could accurately measure the closeness between films, enabling precise and relevant recommendations.

Our model demonstrated excellent performance with a 99.75% accuracy on test data. The system was deployed on a user-friendly website, allowing users to view their liked films, select preferred genres or descriptions, and receive real-time recommendations tailored to their preferences.

## Reference

Сафронов, А. (2022, September 14). Искусственный интеллект в поиске. Как Яндекс научился применять нейронные сети, чтобы искать по смыслу, а не по словам. Хабр. https://habr.com/ru/companies/yandex/articles/314222/

Search | Kaggle. (n.d.). https://www.kaggle.com/search?q=Movie+Recommendation+System

## Roles of Members
Team Lead / Data Scientist / Senior ML Developer: Tamerlan Kabdolla -  

Senior Data Miner and preparation / Data Analytic: Aitzhanov Sultan

Senior Data Scientist / Data Miner: Vyacheslav Popov 

Senior Web Developer / Data Miner: Tugambayeva Aruzhan

Senior Project Manager / Data Miner: 
Lyailya Dzhumagulova 

## Bonus

You Tube link

![image](https://github.com/user-attachments/assets/5ff9da3f-3480-469e-986a-902c82df2aa2)


